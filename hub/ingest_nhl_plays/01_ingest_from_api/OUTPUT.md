# NHL Data Ingestion Outputs

This document provides detailed information about the output datasets generated by the NHL Data Ingestion to GCP script. Each dataset is stored in Parquet format within specified directories in Google Cloud Storage (GCS).

## Datasets Overview

### 1. Raw Plays (`raw_plays`)

Contains basic play-by-play event data from NHL games.

#### Columns:

- `game_id`: Unique identifier for the game.
- `away_team`: Abbreviation of the away team.
- `home_team`: Abbreviation of the home team.
- `index`: Index of the play within the game.
- `period`: The period in which the play occurred.
- `status`: Status of the game at the time of the play (Power Play, Even Strength, Short Handed).
- `type`: Type of play (e.g., goal, penalty).
- `detail`: Detailed description of the play.
- `time`: Game clock time at which the play occurred.
- `time_elapsed`: Elapsed time in the game when the play occurred.
- `on_ice`: Array containing information about players on the ice at the time of the play.

### 2. Raw Forwards (`raw_forwards`)

Contains statistics for forwards participating in the game.

#### Columns:

- `playerId`: Unique identifier for the player.
- `sweaterNumber`: Jersey number of the player.
- `name`: Name of the player.
- `position`: Position of the player.
- `goals`: Number of goals scored by the player.
- `assists`: Number of assists made by the player.
- `points`: Total points scored by the player (goals + assists).
- Additional statistics such as `plusMinus`, `pim` (penalties in minutes), `hits`, `blockedShots`, `powerPlayGoals`, `powerPlayPoints`, `shorthandedGoals`, `shPoints`, `shots`, `faceoffs`, `faceoffWinningPctg`, `toi` (time on ice), `powerPlayToi`, and `shorthandedToi`.

### 3. Raw Defense (`raw_defense`)

Contains statistics for defensemen participating in the game.

#### Columns:

Similar to `raw_forwards`, but specific to players in the defensive position.

### 4. Raw Goalies (`raw_goalies`)

Contains statistics for goalies participating in the game.

#### Columns:

- `playerId`, `sweaterNumber`, `name`, `position` (should be 'Goalie').
- Goalie-specific statistics such as `evenStrengthShotsAgainst`, `powerPlayShotsAgainst`, `shorthandedShotsAgainst`, `saveShotsAgainst`, `savePctg`, `evenStrengthGoalsAgainst`, `powerPlayGoalsAgainst`, `shorthandedGoalsAgainst`, `pim`, `goalsAgainst`, `toi`.

### 5. Plays with On-Ice (`plays_with_onice`)

Enriched play-by-play data with detailed on-ice player information.

#### Columns:

- Includes all columns from `raw_plays`.
- `away_onice_codes`: Codes representing away players on the ice, combining position and sweater number.
- `home_onice_codes`: Codes representing home players on the ice, combining position and sweater number.
- `game_id`, `side`, `code`, `playerId`, `default_last_name`, `default_first_init`: Detailed information about players involved in each play.

## Additional Notes

- Data is processed and stored using PySpark, ensuring scalability and efficiency.
- Error handling is implemented to log any issues encountered during data processing, ensuring data integrity and reliability.

For further details or inquiries, please contact the project maintainers.
